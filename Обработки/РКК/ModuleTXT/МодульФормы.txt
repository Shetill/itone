
#Область ComПодключение

&НаСервереБезКонтекста
Функция  ПолучитьПодключениеКФайловойБД()
	
	V83COMConnector  = Новый COMObject("V83.COMConnector");
	Попытка
		
		Возврат V83COMConnector.Connect(ПолучитьПараметрыПодключенияКФайловойБД());
		
	Исключение
		
		Сообщить(ПодробноеПредставлениеОшибки(ОписаниеОшибки()));
		Возврат Неопределено;
		
	КонецПопытки; 
	
КонецФункции

&НаСервереБезКонтекста
Функция ПолучитьПараметрыПодключенияКФайловойБД()
	
	login 		= "adminn";
	password	= "123";
	путьКБазе	= "D:\RomanPetukhov\Базы1С\РКК\УТ10-3";
	
	Возврат "File="+путьКБазе+";Usr="+login+";Pwd="+password+";"; 
	
КонецФункции

#КонецОбласти 

#Область Работа_с_документами

&НаКлиенте
Процедура ЗагрузитьДокументы(Команда)
	
	ПолучитьСписокДокументов();	
		
КонецПроцедуры

&НаКлиенте
Функция ПолучитьСписокДокументов()
	
ПолучитьПоступленияТоваровУслуг();
	
	
КонецФункции

&НаСервере
Функция ПолучитьПоступленияТоваровУслуг()
	
	Соединение = ПолучитьПодключениеКФайловойБД();	
	ЗапросКом = Соединение.newObject("Запрос");
	ЗапросКом.УстановитьПараметр("НачДата", Период.ДатаНачала);
	ЗапросКом.УстановитьПараметр("КонДата", Период.ДатаОкончания);
	ЗапросКом.Текст = 
	"ВЫБРАТЬ
	|	ПоступлениеТоваровУслуг.Дата КАК ДатаДокумента,
	|	ПоступлениеТоваровУслуг.Номер КАК НомерДокумента
	|ИЗ
	|	Документ.ПоступлениеТоваровУслуг КАК ПоступлениеТоваровУслуг
	|ГДЕ
	|	ПоступлениеТоваровУслуг.Дата МЕЖДУ &НачДата И &КонДата";
	
	РезультатЗапроса = ЗапросКом.Выполнить();
	Выборка = РезультатЗапроса.Выбрать();
	
	Пока Выборка.Следующий() Цикл
	      нСтр = СписокДокументов.Добавить();
		  нСтр.ДатаДокумента = Выборка.ДатаДокумента;
		  нСтр.НомерДокумента = Выборка.НомерДокумента;
	КонецЦикла; 
	
КонецФункции

&НаКлиенте
Процедура ПриОткрытии(Отказ)
	Период.ДатаНачала = '20170201';
	Период.ДатаОкончания = '20170228';
КонецПроцедуры


#КонецОбласти 